  <div class="max-w-4xl mx-auto animate-slide-up">
      
      <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">
          {{ isEditMode ? 'Edit Track' : 'Add New Track' }}
        </h1>
        <p class="text-gray-600 mt-2">
          {{ isEditMode 
            ? 'Update the details of your track.' 
            : 'Fill in the details to add a new track to your library.' }}
        </p>
      </div>

      <form [formGroup]="trackForm" (ngSubmit)="onSubmit()" class="space-y-8">
       
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          
          <div class="lg:col-span-2 space-y-6">
           
            <div class="card">
              <h3 class="text-xl font-bold text-gray-800 mb-6 pb-4 border-b border-gray-100">
                <i class="fas fa-info-circle text-primary-600 mr-2"></i>
                Basic Information
              </h3>
              
              <div class="space-y-6">
                
                <div>
                  <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
                    Track Title *
                  </label>
                  <input id="title"
                         type="text"
                         formControlName="title"
                         placeholder="Enter track title"
                         class="input"
                         [class.border-red-500]="isFieldInvalid('title')" />
                  <div *ngIf="isFieldInvalid('title')" class="mt-2 text-sm text-red-600">
                    <span *ngIf="trackForm.get('title')?.errors?.['required']">Title is required</span>
                    <span *ngIf="trackForm.get('title')?.errors?.['maxlength']">Title cannot exceed 50 characters</span>
                  </div>
                  <div class="mt-1 text-xs text-gray-500">
                    {{ trackForm.get('title')?.value?.length || 0 }}/50 characters
                  </div>
                </div>

                
                <div>
                  <label for="artist" class="block text-sm font-medium text-gray-700 mb-2">
                    Artist Name *
                  </label>
                  <input id="artist"
                         type="text"
                         formControlName="artist"
                         placeholder="Enter artist name"
                         class="input"
                         [class.border-red-500]="isFieldInvalid('artist')" />
                  <div *ngIf="isFieldInvalid('artist')" class="mt-2 text-sm text-red-600">
                    <span *ngIf="trackForm.get('artist')?.errors?.['required']">Artist is required</span>
                    <span *ngIf="trackForm.get('artist')?.errors?.['maxlength']">Artist cannot exceed 50 characters</span>
                  </div>
                </div>

            
                <div>
                  <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    Description
                  </label>
                  <textarea id="description"
                            formControlName="description"
                            rows="4"
                            placeholder="Describe this track (optional)"
                            class="input resize-none"
                            maxlength="200"></textarea>
                  <div class="mt-1 text-xs text-gray-500 flex justify-between">
                    <span>Optional description</span>
                    <span>{{ trackForm.get('description')?.value?.length || 0 }}/200</span>
                  </div>
                </div>

                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label for="category" class="block text-sm font-medium text-gray-700 mb-2">
                      Category *
                    </label>
                    <select id="category"
                            formControlName="category"
                            class="input"
                            [class.border-red-500]="isFieldInvalid('category')">
                      <option value="">Select a category</option>
                      <option *ngFor="let category of categories" [value]="category">
                        {{ category }}
                      </option>
                    </select>
                    <div *ngIf="isFieldInvalid('category')" class="mt-2 text-sm text-red-600">
                      Please select a category
                    </div>
                  </div>

                  <div>
                    <label for="duration" class="block text-sm font-medium text-gray-700 mb-2">
                      Duration (seconds) *
                    </label>
                    <input id="duration"
                           type="number"
                           formControlName="duration"
                           placeholder="e.g., 180"
                           min="1"
                           class="input"
                           [class.border-red-500]="isFieldInvalid('duration')" />
                    <div *ngIf="isFieldInvalid('duration')" class="mt-2 text-sm text-red-600">
                      Duration must be at least 1 second
                    </div>
                    <div class="mt-1 text-xs text-gray-500">
                      {{ (trackForm.get('duration')?.value || 0) | duration }}
                    </div>
                  </div>
                </div>
              </div>
            </div>

           
            <div class="card">
              <h3 class="text-xl font-bold text-gray-800 mb-6 pb-4 border-b border-gray-100">
                <i class="fas fa-link text-primary-600 mr-2"></i>
                Media URLs
              </h3>
              
              <div class="space-y-6">
               
                <div>
                  <label for="audioUrl" class="block text-sm font-medium text-gray-700 mb-2">
                    Audio URL *
                  </label>
                  <input id="audioUrl"
                         type="url"
                         formControlName="audioUrl"
                         placeholder="https://example.com/track.mp3"
                         class="input"
                         [class.border-red-500]="isFieldInvalid('audioUrl')" />
                  <div *ngIf="isFieldInvalid('audioUrl')" class="mt-2 text-sm text-red-600">
                    <span *ngIf="trackForm.get('audioUrl')?.errors?.['required']">Audio URL is required</span>
                    <span *ngIf="trackForm.get('audioUrl')?.errors?.['pattern']">Please enter a valid URL starting with http:// or https://</span>
                  </div>
                  <div class="mt-1 text-xs text-gray-500">
                    Supported formats: MP3, WAV, OGG
                  </div>
                </div>

               
                <div>
                  <label for="coverUrl" class="block text-sm font-medium text-gray-700 mb-2">
                    Cover Image URL (optional)
                  </label>
                  <input id="coverUrl"
                         type="url"
                         formControlName="coverUrl"
                         placeholder="https://example.com/cover.jpg"
                         class="input" />
                  <div class="mt-1 text-xs text-gray-500">
                    Optional. Supported formats: JPG, PNG, WebP
                  </div>
                </div>
              </div>
            </div>
          </div>

          
          <div class="space-y-8">
            
            <div class="card bg-gradient-to-br from-primary-50 to-primary-100">
              <h3 class="text-lg font-bold text-primary-800 mb-4">Preview</h3>
              
              <div class="space-y-4">
             
                <div class="aspect-square rounded-lg overflow-hidden bg-gradient-to-br from-primary-200 to-primary-300">
                  <img [src]="previewCoverUrl"
                       [alt]="'Preview: ' + (trackForm.get('title')?.value || 'Untitled')"
                       class="w-full h-full object-cover"
                       (error)="onPreviewImageError($event)" />
                </div>

              
                <div class="space-y-2">
                  <div class="font-bold text-lg text-gray-800 truncate">
                    {{ trackForm.get('title')?.value || 'Untitled Track' }}
                  </div>
                  <div class="text-sm text-gray-600">
                    {{ trackForm.get('artist')?.value || 'Unknown Artist' }}
                  </div>
                  <div class="flex items-center justify-between text-sm">
                    <span class="badge bg-primary-200 text-primary-800">
                      {{ trackForm.get('category')?.value || 'Uncategorized' }}
                    </span>
                    <span class="text-gray-500">
                      {{ (trackForm.get('duration')?.value || 0) | duration }}
                    </span>
                  </div>
                </div>
              </div>
            </div>

           
            <div class="card">
              <h3 class="text-lg font-bold text-gray-800 mb-4">Actions</h3>
              
              <div class="space-y-4">
                <button type="submit"
                        [disabled]="trackForm.invalid || isSubmitting"
                        class="w-full btn btn-primary py-3 text-lg">
                  <app-loading-spinner *ngIf="isSubmitting" 
                                       [message]="''"
                                       class="inline-block"></app-loading-spinner>
                  <span *ngIf="!isSubmitting">
                    <i class="fas" [class.fa-save]="isEditMode" [class.fa-plus]="!isEditMode" class="mr-2"></i>
                    {{ isEditMode ? 'Update Track' : 'Add Track' }}
                  </span>
                </button>

           
                <a routerLink="/"
                   class="w-full btn btn-secondary py-3 text-lg inline-block text-center">
                  <i class="fas fa-times mr-2"></i>
                  Cancel
                </a>

                <div *ngIf="submitError" 
                     class="p-3 bg-red-50 border border-red-200 rounded-lg">
                  <div class="flex items-center">
                    <i class="fas fa-exclamation-circle text-red-500 mr-2"></i>
                    <span class="text-red-700 text-sm">{{ submitError }}</span>
                  </div>
                </div>

                <div *ngIf="trackForm.valid && !isSubmitting && !submitError"
                     class="p-3 bg-green-50 border border-green-200 rounded-lg">
                  <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                    <span class="text-green-700 text-sm">Form is ready to submit</span>
                  </div>
                </div>
              </div>
            </div>

           
            <div class="card">
              <h3 class="text-lg font-bold text-gray-800 mb-4">Validation</h3>
              <div class="space-y-2">
                <div class="flex items-center text-sm"
                     [class.text-green-600]="trackForm.get('title')?.valid"
                     [class.text-red-600]="trackForm.get('title')?.invalid">
                  <i class="fas" [class.fa-check-circle]="trackForm.get('title')?.valid"
                                [class.fa-times-circle]="trackForm.get('title')?.invalid"
                                class="mr-2"></i>
                  Title is {{ trackForm.get('title')?.valid ? 'valid' : 'invalid' }}
                </div>
                <div class="flex items-center text-sm"
                     [class.text-green-600]="trackForm.get('artist')?.valid"
                     [class.text-red-600]="trackForm.get('artist')?.invalid">
                  <i class="fas" [class.fa-check-circle]="trackForm.get('artist')?.valid"
                                [class.fa-times-circle]="trackForm.get('artist')?.invalid"
                                class="mr-2"></i>
                  Artist is {{ trackForm.get('artist')?.valid ? 'valid' : 'invalid' }}
                </div>
                <div class="flex items-center text-sm"
                     [class.text-green-600]="trackForm.get('audioUrl')?.valid"
                     [class.text-red-600]="trackForm.get('audioUrl')?.invalid">
                  <i class="fas" [class.fa-check-circle]="trackForm.get('audioUrl')?.valid"
                                [class.fa-times-circle]="trackForm.get('audioUrl')?.invalid"
                                class="mr-2"></i>
                  Audio URL is {{ trackForm.get('audioUrl')?.valid ? 'valid' : 'invalid' }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>